# MindTrails Movement
This repository contains the protocol for the Mind Trails Movement study, and all the code required to build the protocol from scratch. 

<br>

## Description of this Repo's Root Folders
- üìÅ**make** -- Contains the CSV and Python scripts to "remake" the study surveys and sessions.
- üìÅ**validate** -- Contains Python scripts to check if all Json is properly formatted
- üìÅ**src** -- Contains the raw files that will be copied to device when a participant enrolls in the study

<br>

## Downloading This Repo's Protocol in Digital Trails

This protocol can be downloaded in the Digital Trails app using the study code "MTM" on the initial startup screen.

![image](https://github.com/user-attachments/assets/fd8d9cb9-62e0-47d0-a930-696e55124aab)


<br>

## Regenerating the JSON in This Repo's Protocol

All of the studie's custom content are described by JSON files. To recreate these files:
1. Delete the folders in `src/flows/` (*note*: you should only delete the folders).
2. Run `make/scripts/microdoses.py`, `make/scripts/surveys.py`, and `make/scripts/resources.py`.
3. Copy the folders generated by *Step 2*. The folders will be in the `make/~out/` directory.
4. Paste the output copied in *Step 3* into `src/flows`

<br>

## Releasing This Repo's Protocol to Digital Trails

Follow these steps to make protocol changes availalbe in Digital Trails.
1. Desired protocol changes should be made in the `src` directory
2. After finishing your changes commit them to this repository
3. Once the desired changes have been committed and pushed to GitHub navigate to Releases
   ![image](https://github.com/user-attachments/assets/8b0163f1-abcf-4133-9e83-a2bbc02ddf39)

4. On the Releases page there will be a "Draft a New Release" in the top right

   ![image](https://github.com/user-attachments/assets/30c12a1a-02c6-49e2-b9ff-889936406737)

5. On the Release draft page: (a) enter a new "tag" to identify the release, (b) give it a title, and (c) click "Publish Release"

   ![image](https://github.com/user-attachments/assets/e2a5a667-38c3-4b42-a3be-303274eda021)

6. After publishing it will take about 2 minutes before the protocol will be ready to download in Digital Trails

7. You can monitor the publish process by clicking on Action tab at the top.

   ![image](https://github.com/user-attachments/assets/ddc28f67-d964-4915-a20a-5cdad0a13205)

8. In the Action tab, the publication process will appear at the top of the workflow list. Once the workflow is green it can be downloaded in Digital Trails.

   ![image](https://github.com/user-attachments/assets/b0701c00-dd7b-4962-9b7d-2a9f74df0d32)

<br>

## Releasing Multiple Versions of This Repo's Protocol

In addition to releasing a primary protocol (downloaded with MTM study code) it is also possible to release protcol versions. To do this:

1. Create a new Release as described above, but this time be sure to **unclick** "Set as the latest release"

   ![image](https://github.com/user-attachments/assets/c3686bf3-d15d-4022-a4b4-c51e2878d41c)

2. In Digital Trails enter your study code followed by an @ plus your release tag. For example, if your release tag was `1.0-beta` you'd enter:

   ![image](https://github.com/user-attachments/assets/d9a75037-e209-472a-a654-786e21de6869)


3. You can have as many release versions as you want, but only one "latest release". The "latest release" is always the default download.
